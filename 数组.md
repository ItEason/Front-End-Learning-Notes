# 数组

## leetcode 904.水果成篮-滑动窗口

题目描述：

你正在探访一家农场，农场从左到右种植了一排果树。这些树用一个整数数组 `fruits` 表示，其中 `fruits[i]` 是第 `i` 棵树上的水果 **种类** 。

你想要尽可能多地收集水果。然而，农场的主人设定了一些严格的规矩，你必须按照要求采摘水果：

- 你只有 **两个** 篮子，并且每个篮子只能装 **单一类型** 的水果。每个篮子能够装的水果总量没有限制。
- 你可以选择任意一棵树开始采摘，你必须从 **每棵** 树（包括开始采摘的树）上 **恰好摘一个水果** 。采摘的水果应当符合篮子中的水果类型。每采摘一次，你将会向右移动到下一棵树，并继续采摘。
- 一旦你走到某棵树前，但水果不符合篮子的水果类型，那么就必须停止采摘。

给你一个整数数组 `fruits` ，返回你可以收集的水果的 **最大** 数目。

**示例1**

> 输入：fruits = [1,2,1]
> 输出：3
> 解释：可以采摘全部 3 棵树。

**示例2**

> 输入：fruits = [0,1,2,2]
> 输出：3
> 解释：可以采摘 [1,2,2] 这三棵树。
> 如果从第一棵树开始采摘，则只能采摘 [0,1] 这两棵树。

**示例3**

> 输入：fruits = [3,3,3,1,2,1,1,2,3,3,4]
> 输出：5
> 解释：可以采摘 [1,2,1,1,2] 这五棵树。

### 1.思路

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过题目的描述我们可以将该题的进行简化：求数组连续的子数组，其中该子数组中的数据均只能由`两个不同的数据`组成且`数组下标是连续`的。通过对问题的简化，使用两个指针，分别进行数据的读取,算法的核心部分是：当存储已读取数据的`Map`集合中已经存在两个不同的值时，此时就需要对左指针向后移动一个单位，若右指针指向的数据此时还是第三个数据时，此时循环继续进行，左指针继续移动，直到Map集合中只存在一个数据时，才进执行后续的代码，直到读取完数组的全部数据即可。（附上本人的草稿）



### 2.代码实现

```js
/**
 * @param {number[]} fruits
 * @return {number}
 */
var totalFruit = function (fruits) {
    // 定义并初始化相关的变量
    let result = Number.MIN_VALUE, map = new Map();

    let i = 0, j = 0, len = fruits.length;

    // 算法设计
    while (j < len) {
        // 当map中已经存在了两个变量时，此时已经出现第三个变量
        while (!map.has(fruits[j]) && map.size === 2) {
            // 不断修改结果集
            result = Math.max(result, j - i);
            if (map.get(fruits[i]) - 1 === 0) {
                map.delete(fruits[i]);
            } else {
                map.set(fruits[i], map.get(fruits[i]) - 1);
            }
            i++;
        }
        if (map.has(fruits[j])) {
            map.set(fruits[j], map.get(fruits[j]) + 1);
        } else {
            map.set(fruits[j], 1);
        }
        j++;
    }

    //返回结果
    return Math.max(result, j - i);
};
```

